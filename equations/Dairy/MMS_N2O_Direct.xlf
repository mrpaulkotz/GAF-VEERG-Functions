/*
============================================================================
4.3: Dairy
============================================================================
4.3.1.3 Method 1 â€” Manure Direct N2O Dairy
============================================================================
*/

/* 
--------------------------------------
VEERG_4_3_1_3__1_MMS_N2O_Direct
The total annual direct nitrous oxide emissions 
from manure management systems
FNj : Seasonal faecal nitrogen in each manure management system
UNjm : Seasonal urinary nitrogen in each manure management system
EFm : Nitrous oxide emission factor for each manure management system
Cg :  factor to convert elemental mass of N2O to molecular mass
--------------------------------------
*/

VEERG_4_3_1_3__1a_MMS_N2O_Direct_GWP
  =LAMBDA(
    E,GWPN2O,
     (E * GWPN2O)
   );

VEERG_4_3_1_3__1_MMS_N2O_Direct
  =LAMBDA(
    FNjm,EFm,Cg,UNjm,
     ((FNjm * EFm * Cg) + (UNjm * EFm * Cg)) * 10 ^ -3
   )
;

VEERG_4_3_1_3__1_MMS_N2O_Direct_FunctionName
  =LAMBDA("VEERG_4_3_1_3__1_MMS_N2O_Direct");

VEERG_4_3_1_3__1_MMS_N2O_Direct_Title
  =LAMBDA("The total annual direct nitrous oxide emissions from manure management systems");

VEERG_4_3_1_3__1_MMS_N2O_Direct_Variable
  =LAMBDA("E");

VEERG_4_3_1_3__1_MMS_N2O_Direct_Unit
  =LAMBDA("t CO2e");

VEERG_4_3_1_3__1_MMS_N2O_Direct_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (1)");

VEERG_4_3_1_3__1_MMS_N2O_Direct_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_10c");

VEERG_4_3_1_3__1_MMS_N2O_Direct_ReadableEquation
  =LAMBDA("E = ((FNjm x EFm x Cg) + (UNjm x EFm x Cg)) x 10 ^ -3");

VEERG_4_3_1_3__1_MMS_N2O_Direct_Arguments
  =LAMBDA(
    MAKEARRAY(4, 2, 
      LAMBDA(r,c, 
        INDEX({
          "FNjm", "Seasonal faecal nitrogen in each manure management system";
          "EFm", "Seasonal urinary nitrogen in each manure management system";
          "Cg", "Nitrous oxide emission factor for each manure management system";
          "UNjm", "Factor to convert elemental mass of N2O to molecular mass"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__2_FaecalN2OMMS
Faecal nitrogen in each MMS
AFj : Total faecal nitrogen excreted
MMSjm : Manure management system
--------------------------------------
*/

VEERG_4_3_1_3__2_FaecalN2OMMS
  =LAMBDA(
    AFj,MMSjm,
    AFj * MMSjm
   )
;

VEERG_4_3_1_3__2_FaecalN2OMMS_FunctionName
  =LAMBDA("VEERG_4_3_1_3__2_FaecalN2OMMS");

VEERG_4_3_1_3__2_FaecalN2OMMS_Title
  =LAMBDA("Faecal nitrogen in each manure management system");

VEERG_4_3_1_3__2_FaecalN2OMMS_Variable
  =LAMBDA("FNjm");

VEERG_4_3_1_3__2_FaecalN2OMMS_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__2_FaecalN2OMMS_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (2)");

VEERG_4_3_1_3__2_FaecalN2OMMS_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_9a");

VEERG_4_3_1_3__2_FaecalN2OMMS_ReadableEquation
  =LAMBDA("FNjm = AFj x MMSjm");

VEERG_4_3_1_3__2_FaecalN2OMMS_Arguments
  =LAMBDA(
    MAKEARRAY(2, 2, 
      LAMBDA(r,c, 
        INDEX({
          "AFj", "Total faecal nitrogen excreted";
          "MMSjm", "Manure management system"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne
Faecal nitrogen excreted by dairy cattle >1 year old
Nj = Number of dairy cattle in each class
Fj = Nitrogen excreted in faeces
Dj = Duration of stay on the farm (days)
--------------------------------------
*/

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne
  =LAMBDA(
    Nj,Fj,Dj,
    (Nj * Fj * Dj)
  )
;

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_FunctionName
  =LAMBDA("VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_Title
  =LAMBDA("Faecal nitrogen excreted by dairy cattle >1 year old");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_Variable
  =LAMBDA("AFj=1,2,4");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (3a)");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_8a");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_ReadableEquation
  =LAMBDA("AFj=1,2,4 = Nj=1,2,4 x Fj=1,2,4 x Dj=1,2,4");

VEERG_4_3_1_3__3a_FaecalNitrogenExcretedGTOne_Arguments
  =LAMBDA(
    MAKEARRAY(3, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Nj", "Number of dairy cattle in each class";
          "Fj", "Nitrogen excreted in faeces";
          "Dj", "Duration of stay on the farm (days)"
        }, r, c)
      )
    )
  );
/*
--------------------------------------
VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne
Faecal nitrogen excreted by dairy cattle <1 year old
Nj = Number of dairy cattle in each class
Fj = Nitrogen excreted in faeces
FPWj=3,5 = Nitrogen excreted in faeces of pre-weaned heifer and bulls calves
Dj = Duration of stay on the farm (days)
DPWj = Duration of stay of pre-weaned heifer and bull calves on the farm
--------------------------------------
*/

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne
  =LAMBDA(
    Nj,Fj,Dj,FPWj,DPWj,
    (Nj * Fj * Dj) + (Nj * FPWj * DPWj)
   )
;

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_FunctionName
  =LAMBDA("VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_Title
  =LAMBDA("Total faecal nitrogen excreted (AFj=3,5)");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_Variable
  =LAMBDA("AFj=3,5");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (3b)");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_8a");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_ReadableEquation
  =LAMBDA("AFj=3,5 = (Nj=3,5 x Fj=3,5 x Dj=3,5) + (Nj=3,5 x FPWj=3,5 x DPWj=3,5)");

VEERG_4_3_1_3__3b_FaecalNitrogenExcretedLTOne_Arguments
  =LAMBDA(
    MAKEARRAY(5, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Nj", "Number of dairy cattle in each class";
          "Fj", "Nitrogen excreted in faeces";
          "FPWj=3,5", "Nitrogen excreted in faeces of pre-weaned heifer and bulls calves";
          "Dj", "Duration of stay on the farm (days)";
          "DPWj", "Duration of stay of pre-weaned heifer and bull calves on the farm"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__4_NitrogenExcretedInFaeces
Nitrogen excreted in faeces
CPIj : Crude protein intake
DMDj : Dry matter digestibility (fraction)
MEj: Metabolised energy
Ij : Dry matter intake
1 / 6.25 = Factor for converting crude protein into nitrogen
--------------------------------------
*/

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces
  =LAMBDA(
    CPIj,DMDj,MEj,Ij,
    (0.3 * (CPIj * (1 - (DMDj + 0.1))) + 0.105 * (MEj * Ij * 0.008) + (0.0152 * Ij)) * (1 / 6.25)
   )
;

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_FunctionName
  =LAMBDA("VEERG_4_3_1_3__4_NitrogenExcretedInFaeces");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_Title
  =LAMBDA("Nitrogen excreted in faeces");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_Variable
  =LAMBDA("Fj");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_Unit
  =LAMBDA("kg N / head / day");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (4)");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_6");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_ReadableEquation
  =LAMBDA("F, = (0.3 x (CPIj x (1 - (DMDj + 0.1))) + 0.105 x (MEj x Ij x 0.008) + (0.0152 x Ij)) x (1 / 6.25)");

VEERG_4_3_1_3__4_NitrogenExcretedInFaeces_Arguments
  =LAMBDA(
    MAKEARRAY(5, 2, 
      LAMBDA(r,c, 
        INDEX({
          "CPIj", "Crude protein intake";
          "DMDj", "Dry matter digestibility (fraction)";
          "MEj", "Metabolised energy";
          "Ij", "Dry matter intake";
          "1 / 6.25", "Factor for converting crude protein into nitrogen"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__5_MetabolisableEnergy
Metabolisable energy
DMDj : Dry matter digestibility (fraction)
--------------------------------------
*/

VEERG_4_3_1_3__5_MetabolisableEnergy
  =LAMBDA(
    DMDj,
    0.1604 * (DMDj * 100) - 1.037
  )
;

VEERG_4_3_1_3__5_MetabolisableEnergy_FunctionName
  =LAMBDA("VEERG_4_3_1_3__5_MetabolisableEnergy");

VEERG_4_3_1_3__5_MetabolisableEnergy_Title
  =LAMBDA("Metabolisable energy");

VEERG_4_3_1_3__5_MetabolisableEnergy_Variable
  =LAMBDA("MEj");

VEERG_4_3_1_3__5_MetabolisableEnergy_Unit
  =LAMBDA("MJ/kg DM");

VEERG_4_3_1_3__5_MetabolisableEnergy_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (XXX)");

VEERG_4_3_1_3__5_MetabolisableEnergy_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation (XX)");

VEERG_4_3_1_3__5_MetabolisableEnergy_ReadableEquation
  =LAMBDA("MEj = 0.1604 x (DMDj x 100) - 1.037");

VEERG_4_3_1_3__5_MetabolisableEnergy_Arguments
  =LAMBDA(
    MAKEARRAY(1, 2, 
      LAMBDA(r,c, 
        INDEX({
          "DMDj : Dry matter digestibility (fraction)"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__6_CrudeProteinIntake
Crude protein intake of dairy cattle
Ij = Dry matter intake of feed
CPj = crude protein content of feed intake
--------------------------------------
*/

VEERG_4_3_1_3__6_CrudeProteinIntake
  =LAMBDA(
    Ij,CPj,
    Ij * CPj
  )
;

VEERG_4_3_1_3__6_CrudeProteinIntake_FunctionName
  =LAMBDA("VEERG_4_3_1_3__6_CrudeProteinIntake");

VEERG_4_3_1_3__6_CrudeProteinIntake_Title
  =LAMBDA("Crude protein intake of dairy cattle");

VEERG_4_3_1_3__6_CrudeProteinIntake_Variable
  =LAMBDA("CPIj");

VEERG_4_3_1_3__6_CrudeProteinIntake_Unit
  =LAMBDA("kg CP/head/day");

VEERG_4_3_1_3__6_CrudeProteinIntake_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (8)");

VEERG_4_3_1_3__6_CrudeProteinIntake_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_4");

VEERG_4_3_1_3__6_CrudeProteinIntake_ReadableEquation
  =LAMBDA("CPIj = Ij x CPj");

VEERG_4_3_1_3__6_CrudeProteinIntake_Arguments
  =LAMBDA(
    MAKEARRAY(2, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Ij", "Dry matter intake of feed";
          "CPj", "crude protein content of feed intake"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__8_UrinaryNitrogenMMS
Urinary nitrogen in each MMS
AUj : Total urinary nitrogen excreted
MMSjm : Manure management system
--------------------------------------
*/

VEERG_4_3_1_3__8_UrinaryNitrogenMMS
  =LAMBDA(
    AUj,MMSjm,
    AUj * MMSjm
  )
;

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_FunctionName
  =LAMBDA("VEERG_4_3_1_3__8_UrinaryNitrogenMMS");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_Title
  =LAMBDA("Urinary nitrogen in each MMS");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_Variable
  =LAMBDA("UNjm");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (2)");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_9a");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_ReadableEquation
  =LAMBDA("UNjmms = AUj x MMSjm");

VEERG_4_3_1_3__8_UrinaryNitrogenMMS_Arguments
  =LAMBDA(
    MAKEARRAY(2, 2, 
      LAMBDA(r,c, 
        INDEX({
          "AUj", "Total urinary nitrogen excreted";
          "MMSjm", "Manure management system"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne
Urinary nitrogen excreted by dairy cattle >1 year old
Nj = Number of dairy cattle in each class
Uj = Nitrogen excreted in urine
Dj = Duration of stay on the farm (days)
--------------------------------------
*/

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne
  =LAMBDA(
    Nj,Uj,Dj,
    (Nj * Uj * Dj)
  )
;

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_FunctionName
  =LAMBDA("VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_Title
  =LAMBDA("Urinary nitrogen excreted by dairy cattle >1 year old");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_Variable
  =LAMBDA("AUj=1,2,4");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (9a)");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_8b");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_ReadableEquation
  =LAMBDA("AUj=1,2,4 = (Nj=1,2,4 x Uj=1,2,4 x Dj=1,2,4)");

VEERG_4_3_1_3__9a_UrinaryNitrogenExcretedGTOne_Arguments
  =LAMBDA(
    MAKEARRAY(3, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Nj", "Number of dairy cattle in each class";
          "Uj", "Nitrogen excreted in urine";
          "Dj", "Duration of stay on the farm (days)"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne
Urinary nitrogen excreted by dairy cattle <1 year old
Nj = Number of dairy cattle in each class
Uj = Nitrogen excreted in urine
UPWj=3,5 = Nitrogen excreted in urine of pre-weaned heifer and bulls calves
Dj = Duration of stay on the farm (days)
DPWj = Duration of stay of pre-weaned heifer and bull calves on the farm
--------------------------------------
*/

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne
  =LAMBDA(
    Nj,Uj,Dj,UPWj,DPWj,
    (Nj * Uj * Dj) + (Nj * UPWj * DPWj)
  )
;

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_FunctionName
  =LAMBDA("VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_Title
  =LAMBDA("Urinary nitrogen excreted by dairy cattle <1 year old");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_Variable
  =LAMBDA("AUj=3,5");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_Unit
  =LAMBDA("kg N");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (9b)");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_8b");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_ReadableEquation
  =LAMBDA("AUj=3,5 = (Nj=3,5 x Uj=3,5 x Dj=3,5) + (Nj=3,5 x UPWj=3,5 x DPWj=3,5)");

VEERG_4_3_1_3__9b_UrinaryNitrogenExcretedLTOne_Arguments
  =LAMBDA(
    MAKEARRAY(5, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Nj", "Number of dairy cattle in each class";
          "Uj", "Nitrogen excreted in urine";
          "UPWj=3,5", "Nitrogen excreted in urine of pre-weaned heifer and bulls calves";
          "Dj", "Duration of stay on the farm (days)";
          "DPWj", "Duration of stay of pre-weaned heifer and bull calves on the farm"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__10_NitrogenExcretedInUrine
Nitrogen excreted in urine for of dairy cattle 
>1 year old and weaned cattle <1 year old
CPIj : Crude protein intake
NRj : Nitrogen retained in the body
Fj : Nitrogen excreted in faeces
Wj : Liveweight
--------------------------------------
*/

VEERG_4_3_1_3__10_NitrogenExcretedInUrine
  =LAMBDA(
    CPIj,NRj,Fj,Wj,
    (CPIj / 6.25) - NRj - Fj - ((1.1 * 10 ^ -4 * (Wj ^ 0.75)) / 6.25)
  )
;

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_FunctionName
  =LAMBDA("VEERG_4_3_1_3__10_NitrogenExcretedInUrine");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_Title
  =LAMBDA("Nitrogen excreted in urine for of dairy cattle >1 year old and weaned cattle <1 year old");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_Variable
  =LAMBDA("Uj");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_Unit
  =LAMBDA("kg N / head / day");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (4)");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_6");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_ReadableEquation
  =LAMBDA("Uj = (CPIj / 6.25) - NRj - Fj - ((1.1 x 10 ^ -4 x (Wj ^ 0.75)) / 6.25)");

VEERG_4_3_1_3__10_NitrogenExcretedInUrine_Arguments
  =LAMBDA(
    MAKEARRAY(4, 2, 
      LAMBDA(r,c, 
        INDEX({
          "CPIj", "Crude protein intake";
          "NRj", "Nitrogen retained in the body";
          "Fj", "Nitrogen excreted in faeces";
          "Wj", "Liveweight"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__11_NitrogenRetainedInTheBody
Nitrogen retained in the body
MPj = Milk production in kg per head per day
Lj = Intake relative to maintenance
Zj : Relative size
LWGj : Liveweight gain
MC = conversion factor for milk in litres to kg
--------------------------------------
*/

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody
  =LAMBDA(
    MPj,MC,Lj,Zj,LWGj,
    ((0.032 * MPj * MC) / 6.38) + ((0.212 - 0.008 * (Lj - 2) - ((0.14 - 0.008 * (Lj - 2)) / (1 + EXP(-6 * (Zj - 0.4))))) * (LWGj * 0.92)) * (1 / 6.25)
  )
;

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_FunctionName
  =LAMBDA("VEERG_4_3_1_3__11_NitrogenRetainedInTheBody");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_Title
  =LAMBDA("Nitrogen retained in the body");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_Variable
  =LAMBDA("NRj");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_Unit
  =LAMBDA("kg N / head / day");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation(11)");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.B.1a_5");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_ReadableEquation
  =LAMBDA("NRj = ((0.032 x MPj x MC) / 6.38) + ((0.212 - 0.008 x (Lj - 2) - ((0.14 - 0.008 x (Lj - 2)) / (1 + EXP(-6 x (Zj - 0.4))))) x (LWGj x 0.92)) x (1 / 6.25)");

VEERG_4_3_1_3__11_NitrogenRetainedInTheBody_Arguments
  =LAMBDA(
    MAKEARRAY(5, 2, 
      LAMBDA(r,c, 
        INDEX({
          "MPj", "Milk production in kg per head per day"; 
          "Lj", "Intake relative to maintenance";
          "Zj", "Relative size";
          "LWGj", "Liveweight gain";
          "MC", "conversion factor for milk in litres to kg"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__12_IntakeRelativeToMaintenance
Intake relative to maintenance
Ij = Dry matter intake of feed
Wj = Liveweight (kg)
LWG = Liveweight gain for maintenance
MRj = increase in metabolic rate when producing milk 
MIj = The additional intake required for milk production
--------------------------------------
*/

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance
  =LAMBDA(
    Ij,Wj,MRj,Mij,
    Ij / (((1.185 + 0.00454 * Wj - 0.0000026 * (Wj ^ 2)) ^ 2) * MRj * Mij)
  )
;

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_FunctionName
  =LAMBDA("VEERG_4_3_1_3__12_IntakeRelativeToMaintenance");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_Title
  =LAMBDA("Intake relative to maintenance");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_Variable
  =LAMBDA("Lj");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_Unit
  =LAMBDA("");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (12)");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation 3.A.1a_1 and Equation 3.B.1a_5");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_ReadableEquation
  =LAMBDA("Lj = Ij / (((1.185 + 0.00454 x Wj - 0.0000026 x (Wj ^ 2)) ^ 2) x MRj x Mij)");

VEERG_4_3_1_3__12_IntakeRelativeToMaintenance_Arguments
  =LAMBDA(
    MAKEARRAY(5, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Ij", "Dry matter intake of feed";
          "Wj", "Liveweight (kg)";
          "LWG", "Liveweight gain for maintenance";
          "MRj", "increase in metabolic rate when producing milk";
          "MIj", "The additional intake required for milk production"
        }, r, c)
      )
    )
  );

/*
--------------------------------------
VEERG_4_3_1_3__13_RelativeSize
Relative size of each livestock class
W : Liveweight
SRW : Standard reference weight
--------------------------------------
*/

VEERG_4_3_1_3__13_RelativeSize
  =LAMBDA(
    Wj,SRWj,
    Wj / SRWj
  )
;

VEERG_4_3_1_3__13_RelativeSize_FunctionName
  =LAMBDA("VEERG_4_3_1_3__13_RelativeSize");

VEERG_4_3_1_3__13_RelativeSize_Title
  =LAMBDA("Relative size of each livestock class");

VEERG_4_3_1_3__13_RelativeSize_Variable
  =LAMBDA("Zj");

VEERG_4_3_1_3__13_RelativeSize_Unit
  =LAMBDA("");

VEERG_4_3_1_3__13_RelativeSize_Source
  =LAMBDA("VEERG 2026: 4.3.1.3, Equation (XXX)");

VEERG_4_3_1_3__13_RelativeSize_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: Equation XXXX");

VEERG_4_3_1_3__13_RelativeSize_ReadableEquation
  =LAMBDA("Zj = Wj / SRWj");

VEERG_4_3_1_3__13_RelativeSize_Arguments
  =LAMBDA(
    MAKEARRAY(2, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Wj", "Liveweight";
          "SRWj", "Standard reference weight"
        }, r, c)
      )
    )
  );
