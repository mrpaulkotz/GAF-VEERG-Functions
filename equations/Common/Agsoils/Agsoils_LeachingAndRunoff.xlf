/*
============================================================================
National Inventory Report 2023 reference:
Agricultural soils: Leaching and Runoff (3.D.b.2)
============================================================================
*/

/* 
--------------------------------------
AgSoils_LeachingAndRunoff
Leaching and runoff emissions from crop residue,
inorganic and organic fertiliser applied to soil,
urine and dung deposited on pasture
EN2Oleach = Mleach * EFleach * CgN2O * 10 ^ - 3
Mleach : Mass of nitrogen lost to leached and run off : kg N
EFleach : Emission factor for leaching and runoff : kg N2O-N/kg N
CgN2O : Factor to convert elemental mass of N2O to molecular mass
--------------------------------------
*/
AgSoils_LeachingAndRunoff_GWP
 =LAMBDA(
    EN2Oleach,GWPN2O,
     (EN2Oleach * GWPN2O)
   );

AgSoils_LeachingAndRunoff
  =LAMBDA(
    Mleach,EFleach,CgN2O,
    (Mleach * EFleach * CgN2O * 10^-3)
  )
;

AgSoils_LeachingAndRunoff_Title
  =LAMBDA("Leaching and runoff emissions from crop residue,inorganic and organic fertiliser applied to soil, urine and dung deposited on pasture");

AgSoils_LeachingAndRunoff_Variable
  =LAMBDA("EN2Oleach");

AgSoils_LeachingAndRunoff_Unit
  =LAMBDA("t N2O");

AgSoils_LeachingAndRunoff_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: 3.D.B_10");

AgSoils_LeachingAndRunoff_ReadableEquation
  =LAMBDA("EN2Oleach = Mleach * EFleach * CgN2O * 10 ^ - 3");

AgSoils_LeachingAndRunoff_Arguments
  =LAMBDA(
    MAKEARRAY(3, 3, 
      LAMBDA(r,c, 
        INDEX({
          "Mleach","Mass of nitrogen lost to leached and run off","kg N";
          "EFleach","Emission factor for leaching and runoff","kg N2O-N/kg N";
          "CgN2O","Factor to convert elemental mass of N2O to molecular mass",""
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
AgSoils_MassAnimalWasteNLost
Mass of nitrogen lost from manure, urine and dung to leaching and runoff
Mleachanimalwaste=(MNjm+UNjm+FNjm)*FracWET*FracLEACH
Mleachanimalwaste
kg N
MNjm : Mass of nitrogen in manure applied to soils : kg N
UNjm : Mass of nitrogen in urine deposited on pasture, range and paddock : kg N
FNjm : Mass of nitrogen in dung deposited on pasture,range and paddock : kg N
FracWET : Fraction of N available for leaching and runoff in the climate zone of the entity : fraction
FracLEACH : Fraction of N that is lost through leaching and runoff : fraction
--------------------------------------
*/

AgSoils_MassAnimalWasteNLost
  =LAMBDA(
    MNjm,UNjm,FNjm,FracWET,FracLEACH,
    (MNjm+UNjm+FNjm)*FracWET*FracLEACH
  )
;

AgSoils_MassAnimalWasteNLost_Title
  =LAMBDA("Mass of nitrogen lost from manure, urine and dung to leaching and runoff");

AgSoils_MassAnimalWasteNLost_Variable
  =LAMBDA("Mleachanimalwaste");

AgSoils_MassAnimalWasteNLost_Unit
  =LAMBDA("kg N");

AgSoils_MassAnimalWasteNLost_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: 3.D.B_6");

AgSoils_MassAnimalWasteNLost_ReadableEquation
  =LAMBDA("Mleachanimalwaste=(MNjm+UNjm+FNjm)*FracWET*FracLEACH");

AgSoils_MassAnimalWasteNLost_Arguments
  =LAMBDA(
    MAKEARRAY(3, 3, 
      LAMBDA(r,c, 
        INDEX({
          "MNjm","Mass of nitrogen in manure applied to soils","kg N";
          "UNjm","Mass of nitrogen in urine deposited on pasture, range and paddock","kg N";
          "FNjm","Mass of nitrogen in dung deposited on pasture,range and paddock","kg N";
          "FracWET","Fraction of nitrogen available for leaching and runoff in the climate zone of the entity","fraction";
          "FracLEACH","Fraction of nitrogen that is lost through leaching and runoff","fraction"
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
AgSoils_MassInorganicFertiliserNLost
Mleachinorganic
Mleachinorganic = M * FracWET * FracLEACH
M : Mass of nitrogen in inorganic fertiliser applied to soils : kg N
FracWET : Fraction of nitrogen available for leaching and runoff in the climate zone of the entity : fraction
FracLEACH : Fraction of nitrogen that is lost through leaching and runoff : fraction
--------------------------------------
*/

AgSoils_MassInorganicFertiliserNLost
  =LAMBDA(
    M, FracWET, FracLEACH,
    M * FracWET * FracLEACH
  )
;

AgSoils_MassInorganicFertiliserNLost_Title
  =LAMBDA("Mass of nitrogen lost from inorganic fertiliser to leaching and runoff");

AgSoils_MassInorganicFertiliserNLost_Variable
  =LAMBDA("Mleachinorganic");

AgSoils_MassInorganicFertiliserNLost_Unit
  =LAMBDA("kg N");

AgSoils_MassInorganicFertiliserNLost_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: 3.D.B_5");

AgSoils_MassInorganicFertiliserNLost_ReadableEquation
  =LAMBDA("Mleachinorganic = M * FracWET * FracLEACH");

AgSoils_MassInorganicFertiliserNLost_Arguments
  =LAMBDA(
    MAKEARRAY(3, 3, 
      LAMBDA(r,c, 
        INDEX({
          "M","Mass of nitrogen in inorganic fertiliser applied to soils","kg N";
          "FracWET","Fraction of nitrogen available for leaching and runoff in the climate zone of the entity","fraction";
          "FracLEACH","Fraction of nitrogen that is lost through leaching and runoff","fraction"
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
AgSoils_MassCropResidueNLost
Mleachresidue
Mleachresidue = M * FracWET * FracLEACH
M : Mass of nitrogen in crop residue applied to soils : kg N
FracWET : Fraction of nitrogen available for leaching and runoff in the climate zone of the entity : fraction
FracLEACH : Fraction of nitrogen that is lost through leaching and runoff : fraction
--------------------------------------
*/

AgSoils_MassCropResidueNLost
  =LAMBDA(
    M, FracWET, FracLEACH,
    M * FracWET * FracLEACH
  )
;

AgSoils_MassCropResidueNLost_Title
  =LAMBDA("Mass of nitrogen lost from crop residue to leaching and runoff");

AgSoils_MassCropResidueNLost_Variable
  =LAMBDA("Mleachresidue");

AgSoils_MassCropResidueNLost_Unit
  =LAMBDA("kg N");

AgSoils_MassCropResidueNLost_NIRReference
  =LAMBDA("National Inventory Report Volume 1, 2023: 3.D.B_8");

AgSoils_MassCropResidueNLost_ReadableEquation
  =LAMBDA("Mleachresidue = M * FracWET * FracLEACH");

AgSoils_MassCropResidueNLost_Arguments
  =LAMBDA(
    MAKEARRAY(3, 3, 
      LAMBDA(r,c, 
        INDEX({
          "M","Mass of nitrogen in crop residue applied to soils","kg N";
          "FracWET","Fraction of nitrogen available for leaching and runoff in the climate zone of the entity","fraction";
          "FracLEACH","Fraction of nitrogen that is lost through leaching and runoff","fraction"
        }, r, c)
      )
    )
  );


