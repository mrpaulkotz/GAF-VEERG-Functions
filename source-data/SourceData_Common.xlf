/*
============================================================================
============================================================================
Source data that is common across all enterprise types
Excel module name: SourceData_Common
============================================================================
============================================================================
*/

/*
======================================
======================================
Source: National Inventory Report 2023 Volume 1
NIR_2023_Vol1
======================================
======================================
*/

/* 
--------------------------------------
SourceData_Common_DensityOfMethane
p = density of methane (0.6784 kg/m3)
Taken from the National Greenhouse and Energy Reporting 
(Measurement) Determination 2008
--------------------------------------
*/

SourceData_Common_DensityOfMethane_Title
  =LAMBDA("p = density of methane");

SourceData_Common_DensityOfMethane_Unit
  =LAMBDA("kg/m3");

SourceData_Common_DensityOfMethane_Source
  =LAMBDA("National Inventory Report 2023 Volume 1: Equations 3.B.1a_2, 3.B.1c_2, 3.B.3_1, 3.B.4g_2");

SourceData_Common_DensityOfMethane_Data
  =LAMBDA(0.6784);

/* 
--------------------------------------
SourceData_Common_ConvertN2oElementalToMolecularCg
Cg = 44/28 factor to convert elemental mass of N2O to molecular mass
--------------------------------------
*/

SourceData_Common_ConvertN2oElementalToMolecularCg_Title
  =LAMBDA("Factor to convert elemental mass of N2O to molecular mass");

SourceData_Common_ConvertN2oElementalToMolecularCg_Variable
  =LAMBDA("CgN2O");

SourceData_Common_ConvertN2oElementalToMolecularCg_Unit
  =LAMBDA("factor");

SourceData_Common_ConvertN2oElementalToMolecularCg_Source
  =LAMBDA("National Inventory Report 2023 Volume 1");

SourceData_Common_ConvertN2oElementalToMolecularCg_Data
  =LAMBDA(44/28);

/* 
--------------------------------------
SourceData_Common_ConvertGasElementalToMolecular
Factor to convert elemental mass of gas to molecular mass
--------------------------------------
*/

SourceData_Common_ConvertGasElementalToMolecular_Title
  =LAMBDA("Factor to convert elemental mass of gas to molecular mass");

SourceData_Common_ConvertGasElementalToMolecular_Variable
  =LAMBDA("Cg");

SourceData_Common_ConvertGasElementalToMolecular_Unit
  =LAMBDA("factor");

SourceData_Common_ConvertGasElementalToMolecular_Source
  =LAMBDA("XXXXXXX");

SourceData_Common_ConvertGasElementalToMolecular_Data
  =LAMBDA(
    MAKEARRAY(8, 4, 
      LAMBDA(r,c, 
        INDEX({
          "Gas", "Conversion factor", "Conversion factor 1", "Conversion factor 2";
          "CO2", "44/12", 44, 12;
          "CH4", "16/12", 16, 12;
          "N2O", "44/28", 44, 28;
          "Nox", "46/14", 46, 14;
          "CO", "28/12", 28, 12;
          "CO2 Lime", "44/12", 44, 12;
          "NMVOC", "14/12", 14, 12
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_GWPN2O
Global warming potential for greenhouse gases
--------------------------------------
*/

SourceData_Common_GWP_Title
  =LAMBDA("Global warming potential for greenhouse gases");

SourceData_Common_GWP_Variable
  =LAMBDA("GWPN2O");

SourceData_Common_GWP_Unit
  =LAMBDA("factor");

SourceData_Common_GWP_Source
  =LAMBDA("XXXXXXX");

SourceData_Common_GWP_Data
  =LAMBDA(
    MAKEARRAY(8, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Gas", "CO2-e factor";
          "CO2", 1;
          "CH4", 28;
          "N2O", 265;
          "CF4", 6630;
          "C2F6", 12200;
          "SF6", 22800;
          "NF3", 17200
        }, r, c)
      )
    )
  );


/* 
--------------------------------------
SourceData_Common_AustralianStatesTerritories
--------------------------------------
*/

SourceData_Common_AustralianStatesTerritories_Title
  =LAMBDA("Australian states and territories");

SourceData_Common_AustralianStatesTerritories_Variable
  =LAMBDA("");

SourceData_Common_AustralianStatesTerritories_Unit
  =LAMBDA("");

SourceData_Common_AustralianStatesTerritories_Source
  =LAMBDA("");

SourceData_Common_AustralianStatesTerritories_Data
   =LAMBDA(
    MAKEARRAY(9, 3, 
      LAMBDA(r,c, 
        INDEX({
          "State/Territory", "Common Name", "Abbreviation";
          "New South Wales", "New South Wales", "NSW";
          "Australian Capital Territory", "ACT", "ACT";
          "Victoria", "Victoria", "VIC";
          "Queensland", "Queensland", "QLD";
          "South Australia", "South Australia", "SA";
          "Western Australia", "Western Australia", "WA";
          "Tasmania", "Tasmania", "TAS";
          "Northern Territory", "Northern Territory", "NT"
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_WASA4Areas
--------------------------------------
*/

SourceData_Common_WASA4Areas_Title
  =LAMBDA("ABS Statistcal Areas Level 4 - Western Australia");

SourceData_Common_WASA4Areas_Variable
  =LAMBDA("");

SourceData_Common_WASA4Areas_Unit
  =LAMBDA("");

SourceData_Common_WASA4Areas_Source
  =LAMBDA("Australian Bureau of Statistics (ABS) - Statistical Areas Level 2 - 2021 - Shapefile");

SourceData_Common_WASA4Areas_Data
   =LAMBDA(
    MAKEARRAY(11, 1, 
      LAMBDA(r,c, 
        INDEX({
          "SA 4 Name";
          "Bunbury";
          "Mandurah";
          "Perth - Inner";
          "Perth - North East";
          "Perth - North West";
          "Perth - South East";
          "Perth - South West";
          "Western Australia - Wheat Belt";
          "Western Australia - Outback (North)";
          "Western Australia - Outback (South)"
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_WetAndDryZones
--------------------------------------
*/

SourceData_Common_WetAndDryZones_Title
  =LAMBDA("VEERG Australian wet and dry zones");

SourceData_Common_WetAndDryZones_Variable
  =LAMBDA("");

SourceData_Common_WetAndDryZones_Unit
  =LAMBDA("");

SourceData_Common_WetAndDryZones_Source
  =LAMBDA("VEERG 2026: Table 1.2: Translating climate zones to wet and dry zones");

SourceData_Common_WetAndDryZones_Variation
   =LAMBDA(
    MAKEARRAY(3, 1, 
      LAMBDA(r,c, 
        INDEX({
          "VARIATION OF SOURCE DATA:";
          "Added warm / cool temperate moist / dry - low frost and high temp classes to accommodate climate scenarios excluded by VEERG criteria.";
          "Fixed typo - Changed 'Fry' to 'Dry'."
        }, r, c)
      )
    )
  );

SourceData_Common_WetAndDryZones_Data
   =LAMBDA(
    MAKEARRAY(15, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Climate Zone", "Wet or Dry Zone";
          "Tropical montane", "Wet";
          "Tropical wet", "Wet";
          "Tropical moist", "Wet";
          "Tropical dry", "Dry";
          "Warm temperate moist", "Wet";
          "Warm temperate dry", "Dry";
          "Cool temperate moist", "Wet";
          "Cool temperate dry", "Dry";
          "Warm temperate moist - low frost", "Wet";
          "Warm temperate dry - low frost", "Dry";
          "Warm temperate moist - high temp", "Wet";
          "Warm temperate dry - high temp", "Dry";
          "Cool temperate moist - low frost", "Wet";
          "Cool temperate dry - low frost", "Dry"
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_ClimateZones
--------------------------------------
*/

SourceData_Common_ClimateZones_Title
  =LAMBDA("VEERG Australian climate zones");

SourceData_Common_ClimateZones_Variable
  =LAMBDA("");

SourceData_Common_ClimateZones_Unit
  =LAMBDA("");

SourceData_Common_ClimateZones_Source
  =LAMBDA("VEERG 2026: Table 1.3: Climate and Rainfall zone classifications and definitions");

SourceData_Common_ClimateZones_Variation
   =LAMBDA(
    MAKEARRAY(5, 1, 
      LAMBDA(r,c, 
        INDEX({
          "VARIATION OF SOURCE DATA:";
          "Added warm / cool temperate moist / dry - low frost and high temp classes to accommodate climate scenarios excluded by VEERG criteria.";
          "Fixed typo in MAT value for warm temperate dry - changed 10 to 11.";
          "Added min and max columns for MAT, MAP, frost days per year, elevation, MAP:PET to calculate zones from real climate data.";
          "GAF accepts rainfall as a proxy for precipitation."
        }, r, c)
      )
    )
  );

SourceData_Common_ClimateZones_Data
   =LAMBDA(
    MAKEARRAY(15, 16, 
      LAMBDA(r,c, 
        INDEX({
          "Climate Zone", "MAT", "MAP", "Frost days per year", "Elevation", "MAP:PET", "Min temp", "Max temp", "Min rainfall", "Max rainfall", "Min frost days", "Max frost days", "Min elevation", "Max elevation", "Min MAP:PET", "Min MAP:PET";
          "Tropical montane", "> 18 C", "N/A", "β‰¤ 7", "> 1000 m", "N/A", 18.001, 999999, -999999, 999999, -999999, 7, 1000, 999999, -999999, 999999;
          "Tropical wet", "> 18 C", "> 2000 mm", "β‰¤ 7", "β‰¤ 1000 m", "N/A", 18.001, 999999, 2000.001, 999999, -999999, 7, -999999, 999.999,  -999999, 999999;
          "Tropical moist", "> 18 C", "1000 mm - 2000 mm", "β‰¤ 7", "β‰¤ 1000 m", "N/A", 18.001, 999999, 1000, 2000, -999999, 7, -999999, 999.999,  -999999, 999999;
          "Tropical dry", "> 18 C", "< 1000 mm", "β‰¤ 7", "β‰¤ 1000 m", "N/A", 18.001, 999999, -999999, 999.999, -999999, 7, -999999, 999.999,  -999999, 999999;
          "Warm temperate moist", "11 C - 18 C", "N/A", "> 7", "N/A", "> 1", 11, 18, -999999, 999999, 8, 999999, -999999, 999999, 1.001, 999999;
          "Warm temperate dry", "11 C - 18 C", "N/A", "> 7", "N/A", "β‰¤ 1", 11, 18, -999999, 999999, 8, 999999, -999999, 999999,  -999999, 1;
          "Cool temperate moist", "0 C - 10 C", "N/A", "> 7", "N/A", "> 1", -999999, 10.999, -999999, 999999, 8, 999999, -999999, 999999, 1.001, 999999;
          "Cool temperate dry", "0 C - 10 C", "N/A", "> 7", "N/A", "β‰¤ 1", -999999, 10.999, -999999, 999999, 8, 999999, -999999, 999999,  -999999, 1;
          "Warm temperate moist - low frost", "11 C - 18 C", "N/A", "β‰¤ 7", "N/A", "> 1", 11, 18, -999999, 999999, -999999, 7, -999999, 999999, 1.001, 999999;
          "Warm temperate dry - low frost", "11 C - 18 C", "N/A", "β‰¤ 7", "N/A", "β‰¤ 1", 11, 18, -999999, 999999, -999999, 7, -999999, 999999,  -999999, 1;
          "Warm temperate moist - high temp", "> 18 C", "N/A", "> 7", "N/A", "> 1", 18.001, 999999, -999999, 999999, 8, 999999, -999999, 999999, 1.001, 999999;
          "Warm temperate dry - high temp", "> 18 C", "N/A", "> 7", "N/A", "β‰¤ 1", 18.001, 999999, -999999, 999999, 8, 999999, -999999, 999999,  -999999, 1;
          "Cool temperate moist - low frost", "0 C - 10 C", "N/A", "β‰¤ 7", "N/A", "> 1", -999999, 10.999, -999999, 999999, -999999, 7, -999999, 999999, 1.001, 999999;
          "Cool temperate dry - low frost", "0 C - 10 C", "N/A", "β‰¤ 7", "N/A", "β‰¤ 1", -999999, 10.999, -999999, 999999, -999999, 7, -999999, 999999,  -999999, 1
        }, r, c)
      )
    )
  );

SourceData_Common_ClimateZones_Appendices
   =LAMBDA(
    MAKEARRAY(4, 1, 
      LAMBDA(r,c, 
        INDEX({
          "Note:";
          "MAT = mean annual temperature";
          "MAP = mean annual precipitation";
          "PET = potential evapotranspiration"
        }, r, c)
      )
    )
  );


/* 
--------------------------------------
SourceData_Common_TemperatureZones
--------------------------------------
*/

SourceData_Common_TemperatureZones_Title
  =LAMBDA("VEERG Australian temperature zones");

SourceData_Common_TemperatureZones_Variable
  =LAMBDA("");

SourceData_Common_TemperatureZones_Unit
  =LAMBDA("");

SourceData_Common_TemperatureZones_Source
  =LAMBDA("VEERG 2026: Table 1.3: Climate and Rainfall zone classifications and definitions");

SourceData_Common_TemperatureZones_Variation
  =LAMBDA("VARIATION OF SOURCE DATA: Added extra MAT min and MAT max columns to calculate zone from real temperature data.");

SourceData_Common_TemperatureZones_Data
   =LAMBDA(
    MAKEARRAY(4, 4, 
      LAMBDA(r,c, 
        INDEX({
          "Temperature Zone", "Median Annual Temperature (MAT)", "Min MAT", "Max MAT";
          "Warm", "β‰¥ 26 C", 26, 999999;
          "Temperate", "15 - 25 C", 15, 25.999;
          "Cool", "β‰¤ 14 C", -999999, 14.999
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_RainfallZones
--------------------------------------
*/

SourceData_Common_RainfallZones_Title
  =LAMBDA("VEERG Australian rainfall zones");

SourceData_Common_RainfallZones_Variable
  =LAMBDA("");

SourceData_Common_RainfallZones_Unit
  =LAMBDA("");

SourceData_Common_RainfallZones_Source
  =LAMBDA("VEERG 2026: Table 1.3: Climate and Rainfall zone classifications and definitions");

SourceData_Common_RainfallZones_Variation
  =LAMBDA("VARIATION OF SOURCE DATA: Added extra Rainfall min and Rainfall max columns to calculate zone from real rainfall data.");

SourceData_Common_RainfallZones_Data
   =LAMBDA(
    MAKEARRAY(3, 4, 
      LAMBDA(r,c, 
        INDEX({
          "Rainfall Zone", "Annual rainfall", "Rainfall min", "Rainfall max";
          "High rainfall", "Annual rainfall > 600mm", 600.001, 999999;
          "Low rainfall", "Annual rainfall β‰¤ 600mm", -999999, 600
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Common_LeachingZones
--------------------------------------
*/

SourceData_Common_LeachingZones_Title
  =LAMBDA("VEERG Australian leaching zones");

SourceData_Common_LeachingZones_Variable
  =LAMBDA("");

SourceData_Common_LeachingZones_Unit
  =LAMBDA("");

SourceData_Common_LeachingZones_Source
  =LAMBDA("VEERG 2026: Table 1.3: Climate and Rainfall zone classifications and definitions");

SourceData_Common_LeachingZones_Variation
  =LAMBDA("");

SourceData_Common_LeachingZones_Data
   =LAMBDA(
    MAKEARRAY(4, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Leaching Zone", "Leaching criteria";
          "Leaching occurs", "Ξ£(π‘π‘π‘–π‘›)>Ξ£(πΈπ‘‡0)+π‘ π‘π‘–π‘™ π‘¤π‘π‘΅π‘’π‘ β„π‘π‘™π‘‘π‘–π‘›π‘” π‘π‘π‘π‘π‘π‘–π‘΅π‘¦";
          "Leaching does not occur", "Ξ£(π‘π‘π‘–π‘›)β‰¤Ξ£(πΈπ‘‡0)+π‘ π‘π‘–π‘™ π‘¤π‘π‘΅π‘’π‘ β„π‘π‘™π‘‘π‘–π‘›π‘” π‘π‘π‘π‘π‘π‘–π‘΅π‘¦"
        }, r, c)
      )
    )
  );