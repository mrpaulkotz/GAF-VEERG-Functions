/*
============================================================================
============================================================================
Source data that is common across all crop types
Excel module name: SourceData_Cropping_Common
============================================================================
============================================================================
*/

/*
======================================
======================================
Source: National Inventory Report 2023 Volume 1
NIR_2023_Vol1
======================================
======================================
*/

/* 
--------------------------------------
SourceData_Cropping_Common_N2OEFsInorganicFertiliser
Table 5.21 Nitrous oxide EFs for inorganic fertiliser
--------------------------------------
*/

SourceData_Cropping_Common_N2OEFsInorganicFertiliser_Title
  =LAMBDA("Nitrous oxide EFs for inorganic fertiliser");

SourceData_Cropping_Common_N2OEFsInorganicFertiliser_Unit
  =LAMBDA("Gg N2O-N/ Gg N");

SourceData_Cropping_Common_N2OEFsInorganicFertiliser_Source
  =LAMBDA("National Inventory Report 2023 Volume 1: Table 5.21");

SourceData_Cropping_Common_N2OEFsInorganicFertiliser_Data
  =LAMBDA(
    MAKEARRAY(8, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Production system", "Emission factor";
            "Irrigated pasture", 0.0059;
            "Irrigated crop", 0.007;
            "Non-irrigated pasture", 0.0018;
            "Non-irrigated crop", 0.0041;
            "Sugar cane", 0.0199;
            "Cotton", 0.0053;
            "Horticulture", 0.0064
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Cropping_Common_UreaCO2EF
National Inventory Report 2023 Volume 1: Equation 3.H_1
--------------------------------------
*/

SourceData_Cropping_Common_UreaCO2EF_Title
  =LAMBDA("Emission factor for carbon emissions from urea application");

SourceData_Cropping_Common_UreaCO2EF_Unit
  =LAMBDA("tonne C/tonne urea");

SourceData_Cropping_Common_UreaCO2EF_Source
  =LAMBDA("National Inventory Report 2023 Volume 1: Equation 3.H_1");

SourceData_Cropping_Common_UreaCO2EF_Data
  =LAMBDA(0.2);

/* 
--------------------------------------
SourceData_Cropping_Common_N2OEFOrganicFertiliser
National Inventory Report 2023 Volume 1: Equation 3.H_1
--------------------------------------
*/

SourceData_Cropping_Common_N2OEFOrganicFertiliser_Title
  =LAMBDA("The direct nitrous oxide EF from the organic fertiliser when applied to soils");

SourceData_Cropping_Common_N2OEFOrganicFertiliser_Unit
  =LAMBDA("kg N2O - N / kg N");

SourceData_Cropping_Common_N2OEFOrganicFertiliser_Source
  =LAMBDA("VEERG 2026: 5.2.2.3 Constant parameters");

SourceData_Cropping_Common_N2OEFOrganicFertiliser_NIRReference
  =LAMBDA("IPCC 2019 Refinement Volume 4 Table 11.1 [1, p. 11]");

SourceData_Cropping_Common_N2OEFOrganicFertiliser_Data
  =LAMBDA(
    MAKEARRAY(3, 2, 
      LAMBDA(r,c, 
        INDEX({
          "Climate zone i", "EF i N2O";
            "High rainfall", 0.006;
            "Low rainfall", 0.005
        }, r, c)
      )
    )
  );

/* 
--------------------------------------
SourceData_Cropping_Common_FracGASFfInorganicFertiliser
VEERG 2026:Table 12.2.2.9
IPCC 2019 Refinement Volume 4 Table 11.3 [1, p. 11]
Fraction of inorganic fertiliser f that volatilises as NH3 and NOx
--------------------------------------
*/

SourceData_Cropping_Common_FracGASFfInorganicFertiliser_Title
  =LAMBDA("The direct nitrous oxide EF from the organic fertiliser when applied to soils");

SourceData_Cropping_Common_FracGASFfInorganicFertiliser_Unit
  =LAMBDA("(kg NH3-N + NOx-N)/kg N");

SourceData_Cropping_Common_FracGASFfInorganicFertiliser_Source
  =LAMBDA("VEERG 2026:Table 12.2.2.9");

SourceData_Cropping_Common_FracGASFfInorganicFertiliser_NIRReference
  =LAMBDA("IPCC 2019 Refinement Volume 4 Table 11.3 [1, p. 11]");

SourceData_Cropping_Common_FracGASFfInorganicFertiliser_Data
  =LAMBDA(
    MAKEARRAY(6, 3, 
      LAMBDA(r,c, 
        INDEX({
          "Fertiliser type f","FracGASFf", "Basis";
          "Urea-based fertilisers", 0.15, "Urea";
          "Ammonium-based fertilisers", 0.08, "Ammonium";
          "Nitrate-based fertilisers", 0.01, "Nitrate";
          "Ammonium-nitrate based fertilisers", 0.05, "Ammonium-nitrate";
          "Other fertilisers", 0.11, "Other"
        }, r, c)
      )
    )
  );

  SourceData_Cropping_Common_FracGASFfInorganicFertiliser_Variation
  =LAMBDA(("VARIATION FROM SOURCE DATA: Added extra 'Basis' column with simplified naming to assis with lookups in equations"));


